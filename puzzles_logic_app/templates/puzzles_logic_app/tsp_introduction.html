{% extends "core/base.html" %}
{% load static %}

{% block title %}Traveling Salesman Problem - Introduction{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'core/css/instruction.css' %}">
    <link rel="stylesheet" href="{% static 'core/css/model.definition.css' %}">
{% endblock %}

{% block content %}
<div class="container-fluid introduction-content">
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2">외판원 문제 (Traveling Salesman Problem, TSP)</h1>
    </div>

    <p>
        <strong>외판원 문제(TSP)</strong>는 조합 최적화 분야에서 가장 널리 알려지고 집중적으로 연구된 문제 중 하나입니다.
        문제는 간단합니다: 여러 도시(node)와 각 도시 간의 이동 거리(cost)가 주어졌을 때, 모든 도시를 정확히 한 번씩만 방문하고
        처음 출발했던 도시로 돌아오는 가장 짧은 경로(tour)를 찾는 것입니다.
    </p>
    <p>
        이 문제는 간단한 정의에도 불구하고 도시의 수가 증가함에 따라 가능한 경로의 수가 폭발적으로 늘어나(NP-hard), 최적해를 찾는 것이 매우 어려워지는 것으로 유명합니다. 이 때문에 TSP는 효율적인 알고리즘과 휴리스틱(Heuristic) 기법 개발의 중요한 시험대가 되어왔습니다.
    </p>

    <figure>
        <img src="{% static 'puzzles_logic_app/images/tsp_concept.png' %}"
             alt="외판원 문제 개념도" class="intro-image" style="max-width: 600px;">
        <figcaption class="image-caption">그림 1: TSP 개념 - 수많은 가능한 경로(좌) 중에서, 모든 도시를 한 번씩만 방문하고 돌아오는 가장 짧은 경로(우)를 찾습니다.</figcaption>
    </figure>

    <h4>1. 산업 응용 분야</h4>
    <p>TSP는 단순히 외판원의 경로를 찾는 것을 넘어, '순서'가 중요한 다양한 현실 문제에 적용됩니다.</p>
    <ul>
        <li><strong>물류 및 배송:</strong> 하나의 배송 트럭이 여러 목적지를 방문해야 할 때, 총 운행 거리를 최소화하는 최적의 경로를 계획합니다. (이는 더 복잡한 '차량 경로 문제(VRP)'의 기초가 됩니다.)</li>
        <li><strong>제조 및 생산:</strong> 회로 기판(PCB)에 구멍을 뚫을 때 드릴이 움직이는 경로를 최적화하거나, 로봇 팔이 여러 위치에서 작업을 수행하는 순서를 결정하여 총 작업 시간을 최소화합니다.</li>
        <li><strong>유전체학 (Genomics):</strong> DNA 염기서열을 분석할 때, 수많은 DNA 조각들을 재조합하는 최적의 순서를 찾는 데 응용됩니다.</li>
        <li><strong>천문학:</strong> 천체 망원경이 여러 관측 지점을 순회하는 순서를 최적화하여 관측 시간을 최대화합니다.</li>
    </ul>

    <h4>2. 수리 모델</h4>
    <div class="col-md-8 model-definition-content">
        <h4 class="model-definition-content"><strong>입력 데이터:</strong></h4>
        <ul>
            <li> <strong>\( i, j \in \{1, 2, \dots, n\} \)</strong> : 도시(Node)의 인덱스. \(n\)은 총 도시의 수.</li>
            <li> <strong>\( d_{ij} \)</strong> : 도시 \( i \)에서 도시 \( j \)로 이동하는 거리 또는 비용.</li>
        </ul>

        <h4 class="model-definition-content"><strong>결정 변수:</strong></h4>
        <ul>
            <li> <strong>\( x_{ij} \)</strong> : 경로가 도시 \( i \)에서 도시 \( j \)로 직접 이동하면 1, 아니면 0 (이진 변수)
                <div class="math-block">
                    $$ x_{ij} = \begin{cases} 1 & \text{if the path goes from city } i \text{ to city } j \\ 0 & \text{otherwise} \end{cases} $$
                </div>
            </li>
        </ul>

        <h4 class="model-definition-content"><strong>목표 함수:</strong> 총 이동 거리 최소화</h4>
        <div class="math-block">
            $$ \min \sum_{i=1}^{n} \sum_{j=1, j \ne i}^{n} d_{ij} x_{ij} $$
        </div>

        <h4 class="model-definition-content"><strong>주요 제약 조건</strong></h4>
        <ul>
            <li><strong>진입/진출 제약 (Entry/Exit Constraints):</strong>
                <p>각 도시는 정확히 하나의 도시로부터 도착해야 하며(진입), 정확히 하나의 다른 도시로 출발해야 합니다(진출).</p>
                <div class="math-block">
                    $$ \sum_{i=1, i \ne j}^{n} x_{ij} = 1 \quad (\forall j = 1, \dots, n)$$
                    $$ \sum_{j=1, j \ne i}^{n} x_{ij} = 1 \quad (\forall i = 1, \dots, n)$$
                </div>
            </li>
            <li><strong>부분 경로 제거 제약 (Subtour Elimination Constraints):</strong>
                <p>가장 중요한 제약으로, 전체가 하나의 연결된 경로가 되도록 하고, 여러 개의 분리된 작은 경로(예: 1-2-1, 3-4-3)가 생기는 것을 방지합니다. 이를 위한 여러 공식(formulation)이 존재하며, 그중 대표적인 것이 Miller-Tucker-Zemlin(MTZ) 제약입니다.</p>
            </li>
        </ul>
    </div>

    <h3>3. TSP Demo</h3>
    <div class="card-body">
        <p><strong>TSP Demo</strong>에서는 아래와 같은 기능을 직접 체험해볼 수 있습니다.</p>
        <ul>
            <li>방문할 도시 설정</li>
            <li>최단 경로 정보 확인</li>
        </ul>
        <a href="{% url 'puzzles_logic_app:tsp_demo' %}" class="btn btn-success mt-2">
            데모 페이지로 이동 &rarr;
        </a>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ block.super }}
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
{% endblock %}