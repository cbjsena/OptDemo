{% extends "core/base.html" %}
{% load static %}

{% block title %}Vehicle Routing Problem (VRP) - Introduction{% endblock %}

{% block styles %}
<style>
    .introduction-content {
        line-height: 1.8;
        font-size: 1.05rem;
    }
    .introduction-content h4 {
        margin-top: 1.5rem;
        margin-bottom: 0.75rem;
        color: #0056b3;
        padding-bottom: 0.25rem;
        border-bottom: 2px solid #007bff;
    }
    .introduction-content ul {
        padding-left: 20px;
    }
    .introduction-content li {
        margin-bottom: 0.5rem;
    }
    .math-model-section {
        background-color: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 5px;
        padding: 15px;
        margin-top: 15px;
    }
    .intro-image {
        max-width: 100%;
        height: auto;
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 5px;
        margin-top: 10px;
        margin-bottom: 20px;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
    .image-caption {
        font-size: 0.9rem;
        color: #555;
        text-align: center;
        margin-top: -10px;
        margin-bottom: 20px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid introduction-content">
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2">차량 경로 문제 (Vehicle Routing Problem - VRP)</h1>
    </div>

    <p><strong>범주: Ⅲ. 경로 최적화 및 물류 (Routing & Logistics)</strong></p>
    <p>
        차량 경로 문제(VRP)는 물류 및 운송 관리 분야에서 가장 중요하고 활발히 연구되는 최적화 문제 중 하나입니다. 이 문제는 주어진 제약 조건 하에서 하나 또는 여러 대의 차량이 특정 출발지(차고지, 물류센터 등)에서 시작하여 다수의 고객 지점을 방문하고 다시 출발지로 돌아오는 최적의 경로 집합을 찾는 것을 목표로 합니다.
    </p>

    <figure>
        <img src="{% static 'routing_logistics_app/images/vrp_general_concept.png' %}" alt="VRP 일반 개념도" class="intro-image" style="max-width: 500px;">
        <figcaption class="image-caption">그림 1: VRP의 일반적인 개념 (물류센터와 고객 지점들)</figcaption>
    </figure>

    <h4>1. 문제 설명</h4>
    <p>
        VRP의 기본적인 목표는 총 운행 거리, 총 운행 시간, 총 운송 비용과 같은 특정 비용 함수를 최소화하는 것입니다. 동시에, 각 차량의 용량 제약, 고객 방문 시간 창 제약, 총 근무 시간 제약 등 다양한 현실적인 제약 조건들을 만족해야 할 수 있습니다.
    </p>
    <p>
        VRP는 조합 최적화(Combinatorial Optimization) 문제의 한 종류로, 가능한 경로의 수가 매우 많기 때문에 정확한 최적해를 찾는 것은 계산적으로 매우 어려운 NP-hard 문제에 속합니다. 따라서 소규모 문제에 대해서는 정확한 알고리즘이 사용될 수 있지만, 대규모 실제 문제에 대해서는 주로 휴리스틱(Heuristic) 또는 메타휴리스틱(Metaheuristic) 알고리즘이 사용됩니다.
    </p>

    <h4>2. 산업 응용 분야</h4>
    <ul>
        <li><strong>택배 및 배송 서비스:</strong> 온라인 주문 상품, 식료품 등의 최종 소비자 배송 경로 최적화.</li>
        <li><strong>폐기물 수거:</strong> 생활 쓰레기, 재활용품 등의 수거 차량 경로 계획.</li>
        <li><strong>영업사원 및 서비스 기술자 방문 경로 계획:</strong> 제한된 시간 내에 여러 고객 또는 현장을 효율적으로 방문하기 위한 경로 설정.</li>
        <li><strong>학교 버스 경로 최적화:</strong> 학생들의 통학을 위한 버스 노선 및 정류장 순서 결정.</li>
        <li><strong>공유 자전거/스쿠터 재배치:</strong> 수요가 많은 지역으로 이동 수단을 효율적으로 재배치하기 위한 경로 계획.</li>
    </ul>

    <h4>3. 기본적인 수학적 모델 (개념)</h4>
    <div class="math-model-section">
        <p>VRP는 다양한 변형이 존재하지만, 기본적인 형태는 다음과 같이 정형화될 수 있습니다 (그래프 이론 기반):</p>
        <ul>
            <li><strong>주어진 것:</strong>
                <ul>
                    <li>$G=(V, E)$: 노드(정점) 집합 $V$와 간선(엣지) 집합 $E$로 구성된 그래프.</li>
                    <li>$V = \{0\} \cup C$: 노드 0은 차고지(depot), $C=\{1, 2, ..., n\}$은 고객 집합.</li>
                    <li>$c_{ij}$: 노드 $i$에서 노드 $j$로 이동하는 데 드는 비용 (거리, 시간 등).</li>
                    <li>$K$: 사용 가능한 차량의 수 (또는 차량 집합).</li>
                    <li>$q_i$: 고객 $i$의 수요량 (용량 제약 VRP의 경우).</li>
                    <li>$Q_k$: 차량 $k$의 용량 (용량 제약 VRP의 경우).</li>
                </ul>
            </li>
            <li><strong>결정 변수:</strong>
                <ul>
                    <li>$x_{ijk}$: 차량 $k$가 간선 $(i, j)$를 통과하면 1, 아니면 0 (이진 변수).</li>
                    <li>$y_{ik}$: 고객 $i$를 차량 $k$가 방문하면 1, 아니면 0 (이진 변수, 선택 사항).</li>
                </ul>
            </li>
            <li><strong>목표 함수 (예: 총 비용 최소화):</strong>
                <span class="math-formula">Minimize  $\sum_{k \in K} \sum_{(i,j) \in E} c_{ij} x_{ijk}$</span>
            </li>
            <li><strong>주요 제약 조건 (예시):</strong>
                <ul>
                    <li>각 고객은 정확히 한 대의 차량에 의해 방문되어야 함: $\sum_{k \in K} y_{ik} = 1, \quad \forall i \in C$.  (또는 $\sum_{k \in K} \sum_{j \in V, j \ne i} x_{jik} = 1$)</li>
                    <li>차량은 차고지에서 출발하고 차고지로 돌아와야 함.</li>
                    <li>각 차량의 경로 연속성 (들어온 차량은 반드시 나가야 함).</li>
                    <li>부분 경로 제거 제약 (Subtour Elimination Constraints): 한 차량이 차고지를 거치지 않고 고객들 사이만 순회하는 것을 방지.</li>
                    <li>(CVRP의 경우) 각 차량의 총 배송/수거량은 차량 용량을 초과할 수 없음.</li>
                    <li>(VRPTW의 경우) 각 고객 방문은 지정된 시간 창 내에 이루어져야 함.</li>
                </ul>
            </li>
        </ul>
        <p>이러한 모델은 OR-Tools의 Routing Library와 같은 전문 솔버를 통해 해를 구할 수 있습니다.</p>
    </div>
    <figure>
        <img src="{% static 'routing_logistics_app/images/vrp_example_solution.png' %}" alt="VRP 해결 예시 경로" class="intro-image" style="max-width: 600px;">
        <figcaption class="image-caption">그림 2: VRP 문제의 해결 예시 (여러 차량 경로)</figcaption>
    </figure>

    <h4>4. OptDemo에서의 체험</h4>
    <p>
        본 데모의 "차량 경로 문제" 섹션에서는 사용자가 차고지 위치, 고객 지점들의 위치 (및 수요량, 시간 창 등), 사용 가능한 차량 수 (및 용량 등)를 설정하고, OR-Tools를 사용하여 최적화된 차량 경로를 시각적으로 확인하는 과정을 체험할 수 있도록 구성될 예정입니다.
    </p>
</div>
{% endblock %}