{% extends "core/base.html" %}
{% load static %}

{% block title %}Vehicle Routing Problem (VRP) - Introduction{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'core/css/instruction.css' %}">
    <link rel="stylesheet" href="{% static 'core/css/model.definition.css' %}">
{% endblock %}

{% block content %}
<div class="container-fluid introduction-content">
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h2 class="h2">차량 경로 문제 (Vehicle Routing Problem - VRP)</h2>
    </div>

    <p class="lead">
        차량 경로 문제(VRP)는 물류 및 운송 관리 분야에서 가장 중요하고 활발히 연구되는 최적화 문제 중 하나입니다. 이 문제는 주어진 제약 조건 하에서 최적의 차량 운행 경로를 찾아 총비용을 최소화하는 것을 목표로 합니다.
    </p>

    <figure class="text-center my-4">
        <img src="{% static 'routing_logistics_app/images/vrp_general_concept.png' %}" alt="VRP 문제 개념도"
             class="intro-image img-fluid" style="max-width: 600px;">
        <figcaption class="image-caption mt-2">
            그림 1: VRP 문제의 개념 - 중앙 차고지에서 여러 고객 지점으로 향하는 수많은 경로 조합 중, 어떤 경로가 최적인지를 찾는 문제를 시각화합니다.
        </figcaption>
    </figure>

    <div class="row">
        <div class="col-lg-8">
            <h3>1. 문제 설명</h3>
            <p>
                VRP의 기본적인 목표는 총 운행 거리, 총 운행 시간, 총 운송 비용과 같은 특정 비용 함수를 최소화하는 것입니다. 동시에, 각 차량의 용량 제약, 고객 방문 시간 창 제약, 총 근무 시간 제약 등 다양한 현실적인 제약 조건들을 만족해야 합니다. VRP는 계산적으로 매우 어려운 NP-hard 문제에 속하여, 대규모 문제 해결을 위해 주로 휴리스틱(Heuristic) 알고리즘이 사용됩니다.
            </p>

            <h3>2. 산업 응용 분야</h3>
            <ul>
                <li><strong>택배 및 배송 서비스:</strong> 온라인 주문 상품, 식료품 등의 최종 소비자 배송 경로 최적화.</li>
                <li><strong>폐기물 수거:</strong> 생활 쓰레기, 재활용품 등의 수거 차량 경로 계획.</li>
                <li><strong>영업사원 및 서비스 기술자 방문 경로 계획:</strong> 제한된 시간 내에 여러 고객 또는 현장을 효율적으로 방문하기 위한 경로 설정.</li>
                <li><strong>학교 버스 경로 최적화:</strong> 학생들의 통학을 위한 버스 노선 및 정류장 순서 결정.</li>
            </ul>
            <div class="highlight-box">
                <h4>VRP의 주요 구성 요소</h4>
                <ul class="list-unstyled">
                    <li class="mb-3"><strong>물류센터 (Depot)</strong> <span class="icon-inline">🏭</span>: 모든 차량이 운행을 시작하고 종료하는 지점입니다.</li>
                    <li class="mb-3"><strong>고객 (Customers)</strong> <span class="icon-inline">📍</span>: 차량이 방문하여 서비스를 제공해야 하는 지점들입니다.</li>
                    <li class="mb-3"><strong>차량 (Vehicles)</strong> <span class="icon-inline">🚛</span>: 고객에게 서비스를 제공하는 운송 수단으로, 용량이나 운행 시간 등 제약을 가질 수 있습니다.</li>
                    <li class="mb-0"><strong>경로 (Routes)</strong> <span class="icon-inline">🗺️</span>: 각 차량이 물류센터에서 출발하여 고객들을 방문하고 돌아오는 최적화의 대상이 되는 여정입니다.</li>
                </ul>
            </div>

             <figure class="text-center my-4">
                <img src="{% static 'routing_logistics_app/images/vrp_example_solution.png' %}" alt="VRP 해결 예시"
                    class="intro-image img-fluid" style="max-width: 700px;">
                <figcaption class="image-caption mt-2">
                    그림 2: VRP 문제의 해결 예시 - 최적화 솔루션을 통해 각 차량(색상별로 구분)이 어떤 고객을 어떤 순서로 방문해야 하는지에 대한 최적 경로가 도출됩니다.
                </figcaption>
            </figure>

            <h3>3. 수학적 모델</h3>
            <p>
                다음은 가장 대표적인 VRP의 수학적 모델입니다.
            </p>
            <div class="model-definition-content">
                <h4 class="model-definition-content"><strong>입력 데이터:</strong></h4>
                <ul>
                    <li><strong>\(K\)</strong> : 사용 가능한 차량의 집합 (인덱스: \(k\))</li>
                    <li><strong>\(N\)</strong> : 방문해야 할 고객 노드의 집합 (인덱스: \(i, j\), 단 \(i, j \neq 0\))</li>
                    <li><strong>\(N_0\)</strong> : 차고지(Depot, 인덱스: 0)를 포함한 모든 노드의 집합. 즉, \(N_0 = N \cup \{0\}\)</li>
                    <li><strong>\( d_{ij} \)</strong> : 노드 \( i \) 에서 노드 \( j \) 로 이동하는 비용 또는 거리</li>
                </ul>
                <hr>

                <h4 class="model-definition-content"><strong>결정 변수:</strong></h4>
                <ul>
                    <li> <strong>\( x_{ijk} \)</strong> : 차량 \( k \) 가 노드 \( i \) 에서 노드 \( j \) 로 이동하면 1, 아니면 0(이진 변수)</li>
                </ul>
                <hr>

                <h4 class="model-definition-content"><strong>목적 함수:</strong> 총 이동 거리 최소화</h4>
                <div class="math-block">
                    $$ \min \sum_{k \in K} \sum_{i \in N_0} \sum_{j \in N_0, i \neq j} d_{ij} \cdot x_{ijk} $$
                </div>

                <h4 class="model-definition-content"><strong>제약 조건:</strong></h4>
                <ul>
                    <li><strong>고객 방문 제약:</strong> 각 고객은 정확히 한 번, 하나의 차량에 의해 방문되어야 합니다.
                        <div class="math-block">
                            $$\sum_{k \in K} \sum_{i \in N_0, i \ne j} x_{ijk} = 1 \quad \forall j \in N $$
                        </div>
                    </li>
                    <li><strong>차고지 출발 제약:</strong> 사용되는 모든 차량은 차고지에서 출발하여, 임무 완료 후 차고지로 복귀해야 합니다.
                        <div class="math-block">
                            $$\sum_{j \in N} x_{0jk} = \sum_{i \in N} x_{i0k} \le 1 \quad \forall k \in K $$
                        </div>
                    </li>
                    <li><strong>차량 흐름 보존:</strong> 차량이 고객 \( h \) 에 들어왔다면, 반드시 해당 노드를 떠나야 합니다.
                        <div class="math-block">
                            $$\sum_{i \in N_0, i \ne h} x_{ihk} - \sum_{j \in N_0, j \ne h} x_{hjk} = 0 \quad \forall h \in N, k \in K$$
                        </div>
                    </li>
                    <li><strong>부분 경로 제거(Sub-tour Elimination):</strong>
                        이 제약들은 한 차량이 차고지를 거치지 않고 고객들 사이만을 순회하는 작은 독립된 경로(subtour)를 형성하는 것을 방지합니다.
                        상세 수식은 복잡하여 여기서는 생략합니다.
                    </li>
                </ul>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card shadow-sm sticky-top" style="top: 20px;">
                <div class="card-header bg-success text-white">
                    <h4 class="h5 mb-0">VRP Demo 체험하기</h4>
                </div>
                <div class="card-body">
                    <p><strong>VRP Demo</strong>에서는 아래와 같은 기능을 직접 체험해볼 수 있습니다.</p>
                    <ul>
                        <li>고객 수와 차량 수 설정</li>
                        <li>차고지와 고객 위치 설정</li>
                        <li>최적화된 차량 경로 시각화</li>
                    </ul>
                    <a href="{% url 'routing_logistics_app:vrp_demo' %}" class="btn btn-success btn-block mt-3">
                        데모 페이지로 이동 &rarr;
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

