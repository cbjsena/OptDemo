{% extends "core/base.html" %}
{% load static %}

{% block title %}Capacitated VRP (CVRP) - Introduction{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'core/css/instruction.css' %}">
    <link rel="stylesheet" href="{% static 'core/css/model.definition.css' %}">
{% endblock %}

{% block content %}
<div class="container-fluid introduction-content">
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h2>용량 제약 차량 경로 문제 (Capacitated VRP - CVRP)</h2>
    </div>

    <p>
        <strong>용량 제약 차량 경로 문제(CVRP)</strong>는 기본적인 차량 경로 문제(VRP)에 현실 세계의 중요한 제약 조건인 차량의 적재 용량을 추가한 확장 모델입니다. 이는 물류 및 배송 분야에서 가장 널리 적용되는 최적화 문제 중 하나입니다.
    </p>

    <h3>1. CVRP의 핵심: 용량과 수요</h3>
    <p>
        기존 VRP의 구성 요소(물류센터, 고객, 차량, 경로)에 다음 두 가지 핵심 요소가 추가됩니다:
    </p>
    <ul>
        <li>
            <strong>고객 수요 (Customer Demand):</strong> 각 고객이 필요로 하는 물품의 양(무게, 부피, 개수 등)입니다. 모든 고객의 수요는 반드시 충족되어야 합니다.
        </li>
        <li>
            <strong>차량 용량 (Vehicle Capacity):</strong> 각 차량이 최대로 실을 수 있는 물품의 양입니다.
        </li>
    </ul>

    <figure>
        <img src="{% static 'routing_logistics_app/images/cvrp_concept.png' %}" alt="CVRP 개념도" class="intro-image" style="max-width: 500px;">
        <figcaption class="image-caption">그림 1: CVRP 개념 - 각 고객은 수요(숫자)를 가지며, 각 차량은 용량(C) 한계를 가집니다.</figcaption>
    </figure>

    <div class="highlight-box">
        <h4>CVRP의 핵심 제약: 용량 제약 (Capacity Constraint)</h4>
        <p>
            <strong>"한 대의 차량이 방문하는 모든 고객들의 수요량 합계는 해당 차량의 용량을 초과할 수 없다."</strong>
        </p>
        <p>
            이 제약 조건 하나가 추가됨으로써 문제는 VRP와 근본적으로 달라집니다. 제한이 없는 VRP에서는 이론적으로 한 대의 차량이 모든 고객을 방문할 수 있었지만, CVRP에서는 고객들의 총수요량이 한 차량의 용량을 초과하는 순간부터 반드시 여러 대의 차량을 사용해야만 합니다.
        </p>
        <p>
            따라서 CVRP는 단순히 최단 경로를 찾는 문제를 넘어, 어떤 고객들을 어떤 차량에 그룹으로 묶어 할당할 것인가(Clustering)와 각 그룹 내에서 어떤 순서로 방문할 것인가(Routing)를 동시에 최적화해야 하는 더 복잡한 문제가 됩니다.
        </p>
    </div>

    <h3>2. 산업 응용 분야</h3>
    <p>CVRP는 적재 용량이 중요한 모든 물류 시나리오에 적용됩니다.</p>
    <ul>
        <li><strong>대량 화물 운송:</strong> 트럭, 화물선 등을 이용한 B2B 물류에서 적재 용량은 가장 중요한 제약 조건 중 하나입니다.</li>
        <li><strong>식료품 및 음료 배달:</strong> 신선식품, 음료수 박스 등 부피나 무게가 큰 상품을 배송할 때 차량의 용량을 고려해야 합니다.</li>
        <li><strong>소매 유통 물류:</strong> 중앙 물류센터에서 여러 지점으로 상품을 공급할 때 각 지점의 주문량을 합산하여 차량 경로를 계획합니다.</li>
        <li><strong>산업 폐기물 수거:</strong> 각 수거 지점의 폐기물 양을 고려하여 수거 트럭의 용량을 초과하지 않는 최적의 수거 경로를 결정합니다.</li>
    </ul>

    <h3>3. 수학적 모델의 변화</h3>
    <div class="col-md-8 model-definition-content">
        <p>CVRP 모델은 기본 VRP 문제에 차량 용량 제약이 추가 됩니다. </p>
        <h4 class="model-definition-content"><strong>입력 데이터:</strong></h4>
        <ul>
            <li><strong>\( q_{i} \)</strong>: 고객 \( i \)의 수요량 (단, \( q_0 \)은 차고지이므로  \( q_0 \) = 0)</li>
            <li><strong>\( Q_{k} \)</strong>: 차량 \( k \)의 용량</li>
        </ul>
        <hr>

        <h4 class="model-definition-content"><strong>결정 변수:</strong></h4>
        <ul>
            <li> <strong>\( y_{ik} \)</strong>: 고객 \( i \) 를 차량 \( k \) 가 방문하면 1, 아니면 0 인 이진 변수</li>
        </ul>
        <hr>

        <h4 class="model-definition-content"><strong>제약 조건:</strong></h4>
        <ul>
            <li><strong>차량 용량 제약:</strong> 각 차량 \( k \) 에 대해, 해당 차량이 방문하는 모든 고객들의 수요 합은
                차량의 용량 \( Q_{k} \) 를 초과할 수 없습니다.
                <div class="math-block">
                    $$\sum_{i \in C} q_i y_{ik} \le Q_k, \quad \forall k \in K$$
                </div>
            </li>
        </ul>
    </div>

    <h3>4. CVRP Demo</h3>
    <div class="card-body">
        <p><strong>CVRP Demo</strong>에서는 아래와 같은 기능을 직접 체험해볼 수 있습니다.</p>
        <ul>
            <li>고객 수와 차량 수, 차량 용량을 설정</li>
            <li>차고지와 고객 위치 설정</li>
            <li>최적화된 차량 경로를 시각적으로 확인</li>
        </ul>
        <a href="{% url 'routing_logistics_app:cvrp_demo' %}" class="btn btn-success mt-2">
            데모 페이지로 이동 &rarr;
        </a>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
{% endblock %}